---
page_title: "terraform-provider-idsec - idsec_policy_vm"
subcategory: "Access Policy"
description: Infrastructure Virtual Machine (VM) policy data source.
---

# idsec_policy_vm (Data Source)

Infrastructure Virtual Machine (VM) policy data source.

## Example Usage

```terraform
data "idsec_policy_vm" "example_policy" {
  policy_id = "example_policy_id"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `behavior` (Attributes) The behavior of the VM access policy, including SSH and RDP profiles. (see [below for nested schema](#nestedatt--behavior))
- `conditions` (Attributes) The time, session, and idle time conditions of the policy (see [below for nested schema](#nestedatt--conditions))
- `delegation_classification` (String) Indicates the user rights for the current policy
- `metadata` (Attributes) Policy metadata id name and extra information (see [below for nested schema](#nestedatt--metadata))
- `policy_id` (String) Policy id to be retrieved
- `principals` (Attributes List) List of users, groups and roles that the policy applies to (see [below for nested schema](#nestedatt--principals))
- `targets` (Attributes) The targets of the VM access policy. This is a list of platform targets to which the policy applies. (see [below for nested schema](#nestedatt--targets))

<a id="nestedatt--behavior"></a>
### Nested Schema for `behavior`

Optional:

- `rdp_profile` (Attributes) The RDP profile for the virtual machine access policy. (see [below for nested schema](#nestedatt--behavior--rdp_profile))
- `ssh_profile` (Attributes) The SSH profile for the virtual machine access policy. (see [below for nested schema](#nestedatt--behavior--ssh_profile))

<a id="nestedatt--behavior--rdp_profile"></a>
### Nested Schema for `behavior.rdp_profile`

Optional:

- `domain_ephemeral_user` (Attributes) The ephemeral domain user method-related data. (see [below for nested schema](#nestedatt--behavior--rdp_profile--domain_ephemeral_user))
- `local_ephemeral_user` (Attributes) The ephemeral local user method-related data. (see [below for nested schema](#nestedatt--behavior--rdp_profile--local_ephemeral_user))

<a id="nestedatt--behavior--rdp_profile--domain_ephemeral_user"></a>
### Nested Schema for `behavior.rdp_profile.domain_ephemeral_user`

Optional:

- `assign_domain_groups` (List of String) The predefined assigned domain groups of the user.
- `assign_groups` (List of String) The predefined assigned local groups of the user.
- `enable_ephemeral_user_reconnect` (Boolean) Indicates whether the ephemeral user can reconnect.


<a id="nestedatt--behavior--rdp_profile--local_ephemeral_user"></a>
### Nested Schema for `behavior.rdp_profile.local_ephemeral_user`

Optional:

- `assign_groups` (List of String) The predefined assigned local groups of the user.
- `enable_ephemeral_user_reconnect` (Boolean) Indicates whether the ephemeral user can reconnect.



<a id="nestedatt--behavior--ssh_profile"></a>
### Nested Schema for `behavior.ssh_profile`

Optional:

- `username` (String) The username on the certificate used to connect.



<a id="nestedatt--conditions"></a>
### Nested Schema for `conditions`

Optional:

- `access_window` (Attributes) Indicate the time frame that the policy will be active (see [below for nested schema](#nestedatt--conditions--access_window))
- `idle_time` (Number) The maximum idle time before the session ends, in minutes.
- `max_session_duration` (Number) Session length

<a id="nestedatt--conditions--access_window"></a>
### Nested Schema for `conditions.access_window`

Optional:

- `days_of_the_week` (List of Number) The days that the policy will be active
- `from_hour` (String) The policy will be active from hour
- `to_hour` (String) The policy will be active to time



<a id="nestedatt--metadata"></a>
### Nested Schema for `metadata`

Optional:

- `created_by` (Attributes) The user who created the policy, and the creation time (see [below for nested schema](#nestedatt--metadata--created_by))
- `description` (String) Description of the policy
- `name` (String) Name of the policy
- `policy_entitlement` (Attributes) The policy target category, location type and policy type (see [below for nested schema](#nestedatt--metadata--policy_entitlement))
- `policy_id` (String) Policy id
- `policy_tags` (List of String) List of tags that related to the policy
- `status` (Attributes) Status of the policy (see [below for nested schema](#nestedatt--metadata--status))
- `time_frame` (Attributes) The time that the policy is active (see [below for nested schema](#nestedatt--metadata--time_frame))
- `time_zone` (String) The time zone of the policy, default is GMT
- `updated_on` (Attributes) The user who updated the policy, and the update time (see [below for nested schema](#nestedatt--metadata--updated_on))

<a id="nestedatt--metadata--created_by"></a>
### Nested Schema for `metadata.created_by`

Optional:

- `time` (String) Time of the change
- `user` (String) Username of the user who made the change


<a id="nestedatt--metadata--policy_entitlement"></a>
### Nested Schema for `metadata.policy_entitlement`

Optional:

- `location_type` (String) The location type of the policy
- `policy_type` (String) Policy type
- `target_category` (String) The target category of the policy


<a id="nestedatt--metadata--status"></a>
### Nested Schema for `metadata.status`

Optional:

- `link` (String) A documentation link for the policy status
- `status` (String) The status type of the policy
- `status_code` (String) The status code of the policy
- `status_description` (String) The status description of the policy


<a id="nestedatt--metadata--time_frame"></a>
### Nested Schema for `metadata.time_frame`

Optional:

- `from_time` (String) Time from which the policy is effective
- `to_time` (String) Time to which the policy is expired


<a id="nestedatt--metadata--updated_on"></a>
### Nested Schema for `metadata.updated_on`

Optional:

- `time` (String) Time of the change
- `user` (String) Username of the user who made the change



<a id="nestedatt--principals"></a>
### Nested Schema for `principals`

Optional:

- `id` (String) The id of the principal
- `name` (String) The name of the principal
- `source_directory_id` (String) The id of the source directory
- `source_directory_name` (String) The name of the source directory
- `type` (String) The type of the principal user, group or role


<a id="nestedatt--targets"></a>
### Nested Schema for `targets`

Optional:

- `aws_resource` (Attributes) The AWS resources for the VM access policy. This includes regions, tags, VPC IDs, and account IDs. (see [below for nested schema](#nestedatt--targets--aws_resource))
- `azure_resource` (Attributes) The Azure resources for the VM access policy. This includes regions, tags, resource groups, VNet IDs, and subscriptions. (see [below for nested schema](#nestedatt--targets--azure_resource))
- `fqdnip_resource` (Attributes) The FQDN/IP resources for the VM access policy. This includes FQDN rules and IP rules. (see [below for nested schema](#nestedatt--targets--fqdnip_resource))
- `gcp_resource` (Attributes) The GCP resources for the VM access policy. This includes regions, labels, VPC IDs, and project IDs. (see [below for nested schema](#nestedatt--targets--gcp_resource))

<a id="nestedatt--targets--aws_resource"></a>
### Nested Schema for `targets.aws_resource`

Optional:

- `account_ids` (List of String) The AWS account IDs where the resources are located. This is a list of account identifiers.
- `regions` (List of String) The AWS regions where the resources are located.
- `tags` (Attributes List) The tags used to match AWS resources. This is a list of key-value pairs. (see [below for nested schema](#nestedatt--targets--aws_resource--tags))
- `vpc_ids` (List of String) The VPC IDs where the resources are located. This is a list of VPC identifiers.

<a id="nestedatt--targets--aws_resource--tags"></a>
### Nested Schema for `targets.aws_resource.tags`

Optional:

- `key` (String)
- `value` (List of String)



<a id="nestedatt--targets--azure_resource"></a>
### Nested Schema for `targets.azure_resource`

Optional:

- `regions` (List of String) The Azure regions where the resources are located.
- `resource_groups` (List of String) The Azure resource groups where the resources are located. This is a list of resource group names.
- `subscriptions` (List of String) The Azure subscription IDs where the resources are located. This is a list of subscription identifiers.
- `tags` (Attributes List) The tags used to match Azure resources. This is a list of key-value pairs. (see [below for nested schema](#nestedatt--targets--azure_resource--tags))
- `vnet_ids` (List of String) The Azure Virtual Network IDs where the resources are located. This is a list of VNet identifiers.

<a id="nestedatt--targets--azure_resource--tags"></a>
### Nested Schema for `targets.azure_resource.tags`

Optional:

- `key` (String)
- `value` (List of String)



<a id="nestedatt--targets--fqdnip_resource"></a>
### Nested Schema for `targets.fqdnip_resource`

Optional:

- `fqdn_rules` (Attributes List) The FQDN rules used to match DNS records. This is a list of FQDN rules. (see [below for nested schema](#nestedatt--targets--fqdnip_resource--fqdn_rules))
- `ip_rules` (Attributes List) The IP rules used to match IP addresses and logical names. This is a list of IP rules. (see [below for nested schema](#nestedatt--targets--fqdnip_resource--ip_rules))

<a id="nestedatt--targets--fqdnip_resource--fqdn_rules"></a>
### Nested Schema for `targets.fqdnip_resource.fqdn_rules`

Optional:

- `computername_pattern` (String) The pattern to match against the computer name. This can be a full FQDN or a partial match.
- `domain` (String) The domain to match against the FQDN. This is optional and can be used to further restrict the match.
- `operator` (String) The operator to use for matching the FQDN. Valid values are EXACTLY, WILDCARD, PREFIX, SUFFIX, and CONTAINS.


<a id="nestedatt--targets--fqdnip_resource--ip_rules"></a>
### Nested Schema for `targets.fqdnip_resource.ip_rules`

Optional:

- `ip_addresses` (List of String) The list of IP addresses to match against. This can include both IPv4 and IPv6 addresses.
- `logical_name` (String) The logical name of the network.
- `operator` (String) The operator to use for matching the IP addresses. Valid values are EXACTLY and WILDCARD.



<a id="nestedatt--targets--gcp_resource"></a>
### Nested Schema for `targets.gcp_resource`

Optional:

- `labels` (Attributes List) The labels used to match GCP resources. This is a list of key-value pairs. (see [below for nested schema](#nestedatt--targets--gcp_resource--labels))
- `projects` (List of String) The GCP project IDs where the resources are located. This is a list of project identifiers.
- `regions` (List of String) The GCP regions where the resources are located.
- `vpc_ids` (List of String) The GCP VPC IDs where the resources are located. This is a list of VPC identifiers.

<a id="nestedatt--targets--gcp_resource--labels"></a>
### Nested Schema for `targets.gcp_resource.labels`

Optional:

- `key` (String)
- `value` (List of String)



