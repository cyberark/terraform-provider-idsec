---
page_title: "terraform-provider-idsec - idsec_uap_vm"
subcategory: idsec_uap_vm
description: UAP SIA VM Policy resource.
---

# idsec_uap_vm (Resource)

UAP SIA VM Policy resource.

## Example Usage

```terraform
resource "idsec_uap_vm" "example_policy" {
  metadata = {
    name        = "example_policy"
    description = "Policy for example virtual machine access",
    status = {
      status = "Active"
    },
    policy_entitlement = {
      target_category = "VM",
      location_type   = "FQDN/IP"
    },
    policy_tags = [],
    time_zone   = "Asia/Jerusalem"
  }
  principals = [
    {
      id   = "DPA_Admin_Role",
      name = "DpaAdmin",
      type = "ROLE"
    }
  ]
  conditions = {
    access_window = {
      days_of_the_week = [1, 2, 3, 4, 5, 6],
      from_hour        = "09:00",
      to_hour          = "17:00"
    },
    max_session_duration = 8
  }
  targets = {
    fqdnipResource = {
      fqdnRules = [
        {
          operator            = "EXACTLY",
          computernamePattern = "myvm.mydomain.com",
          domain              = "domain.com"
        }
      ],
      ipRules = [
        {
          operator = "EXACTLY",
          ipAddresses = [
            "192.168.12.34"
          ],
          logicalName = "CoolLogicalName"
        }
      ]
    }
  }
  behavior = {
    sshProfile = {
      username = "ssh_user"
    },
    rdpProfile = {
      domainEphemeralUser = {
        assignGroups = [
          "rdp_users"
        ],
        enableEphemeralUserReconnect = false,
        assignDomainGroups = [
          "domain_rdp_users"
        ]
      }
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `metadata` (Attributes) The policy metadata: ID, name, and additional information (see [below for nested schema](#nestedatt--metadata))
- `principals` (Attributes List) The identity: user, group, role (see [below for nested schema](#nestedatt--principals))

### Optional

- `behavior` (Attributes) The behavior of the VM access policy, including SSH and RDP profiles. (see [below for nested schema](#nestedatt--behavior))
- `conditions` (Attributes) The time, session, and idle time conditions of the policy (see [below for nested schema](#nestedatt--conditions))
- `delegation_classification` (String) Indicates the user rights for the policy. Default: Unrestricted
- `targets` (Attributes) The targets of the VM access policy. This is a list of platform targets that the policy applies to. (see [below for nested schema](#nestedatt--targets))

<a id="nestedatt--metadata"></a>
### Nested Schema for `metadata`

Required:

- `name` (String) A unique name for the access policy - minLength: 1, maxLength: 200
- `policy_entitlement` (Attributes) The policy target category, location type and policy type (see [below for nested schema](#nestedatt--metadata--policy_entitlement))
- `status` (Attributes) The status of the policy (see [below for nested schema](#nestedatt--metadata--status))
- `time_frame` (Attributes) The timeframe that the policy is active. For an unlimited timeframe, leave empty - maxLength: 50 (see [below for nested schema](#nestedatt--metadata--time_frame))

Optional:

- `created_by` (Attributes) The user who created the policy and when (see [below for nested schema](#nestedatt--metadata--created_by))
- `description` (String) A short description about the policy - maximum 200 characters
- `policy_id` (String) The unique identifier of the access policy - minLength: 0, maxLength: 99
- `policy_tags` (List of String) Customized tags to help identify the policy and those similar to it - maximum 20 tags per policy
- `time_zone` (String) The time zone identifier - maxLength: 50, Default: GMT
- `updated_on` (Attributes) The user who updated the policy, and when (see [below for nested schema](#nestedatt--metadata--updated_on))

<a id="nestedatt--metadata--policy_entitlement"></a>
### Nested Schema for `metadata.policy_entitlement`

Required:

- `location_type` (String) The location of the target: Cloud access: AWS, Azure, GCP; Infrastructure access: FQDN/IP
- `target_category` (String) The category of the target: Cloud access: Cloud console; Infrastructure access: VM, DB

Optional:

- `policy_type` (String) The type of policy - Recurring (Cloud console, VM or DB only) or OnDemand. Default - Recurring. required


<a id="nestedatt--metadata--status"></a>
### Nested Schema for `metadata.status`

Optional:

- `link` (String) Link to documentation when available. maxLength: 255
- `status` (String) The status of the policy
- `status_code` (String) The status code. maxLength: 99
- `status_description` (String) A description of the status. maxLength: 1000


<a id="nestedatt--metadata--time_frame"></a>
### Nested Schema for `metadata.time_frame`

Optional:

- `from_time` (String) pattern: yyyy-MM-ddTHH:mm:ss; The date the policy becomes active (in ISO 8601 format e.g. 2000-01-30T13:00:00)
- `to_time` (String) pattern: yyyy-MM-ddTHH:mm:ss; The date the policy expires (in ISO 8601 format e.g. 2000-02-30T13:00:00)


<a id="nestedatt--metadata--created_by"></a>
### Nested Schema for `metadata.created_by`

Optional:

- `time` (String) The date and time the policy was created or modified (read-only)
- `user` (String) The name of the user that modified the policy (read-only) minLength: 1, maxLength: 512


<a id="nestedatt--metadata--updated_on"></a>
### Nested Schema for `metadata.updated_on`

Optional:

- `time` (String) The date and time the policy was created or modified (read-only)
- `user` (String) The name of the user that modified the policy (read-only) minLength: 1, maxLength: 512



<a id="nestedatt--principals"></a>
### Nested Schema for `principals`

Required:

- `id` (String) The unique identifier of the principal in CyberArk. A principal is a user, group, or role. maxLength: 40
- `name` (String) The name of the principal. minLength: 1
- `type` (String) The type of the principal user, group or role

Optional:

- `source_directory_id` (String) The unique identifier of the directory service. (For Cloud console: If the type is ROLE, then this field is optional.)
- `source_directory_name` (String) The name of the directory service.(For Cloud console: if the type is ROLE, then this field is optional and maxLength:256)


<a id="nestedatt--behavior"></a>
### Nested Schema for `behavior`

Optional:

- `rdp_profile` (Attributes) The RDP profile for this virtual machine access policy (see [below for nested schema](#nestedatt--behavior--rdp_profile))
- `ssh_profile` (Attributes) The SSH profile for this virtual machine access policy (see [below for nested schema](#nestedatt--behavior--ssh_profile))

<a id="nestedatt--behavior--rdp_profile"></a>
### Nested Schema for `behavior.rdp_profile`

Optional:

- `domain_ephemeral_user` (Attributes) Domain ephemeral user method related data (see [below for nested schema](#nestedatt--behavior--rdp_profile--domain_ephemeral_user))
- `local_ephemeral_user` (Attributes) Local ephemeral user method related data (see [below for nested schema](#nestedatt--behavior--rdp_profile--local_ephemeral_user))

<a id="nestedatt--behavior--rdp_profile--domain_ephemeral_user"></a>
### Nested Schema for `behavior.rdp_profile.domain_ephemeral_user`

Optional:

- `assign_domain_groups` (List of String) Predefined assigned domain groups of the user
- `assign_groups` (List of String) Predefined assigned local groups of the user
- `enable_ephemeral_user_reconnect` (Boolean) Whether the ephemeral user can reconnect


<a id="nestedatt--behavior--rdp_profile--local_ephemeral_user"></a>
### Nested Schema for `behavior.rdp_profile.local_ephemeral_user`

Optional:

- `assign_groups` (List of String) Predefined assigned local groups of the user
- `enable_ephemeral_user_reconnect` (Boolean) Whether the ephemeral user can reconnect



<a id="nestedatt--behavior--ssh_profile"></a>
### Nested Schema for `behavior.ssh_profile`

Optional:

- `username` (String) Username which the user will connect with on the certificate



<a id="nestedatt--conditions"></a>
### Nested Schema for `conditions`

Required:

- `access_window` (Attributes) The days and times when the user can connect to their target using this policy (see [below for nested schema](#nestedatt--conditions--access_window))

Optional:

- `idle_time` (Number) The maximum idle time before the session ends, in minutes.
- `max_session_duration` (Number) The maximum length of time (in hours) a user can remain connected in a single session. Default: 1

<a id="nestedatt--conditions--access_window"></a>
### Nested Schema for `conditions.access_window`

Optional:

- `days_of_the_week` (Set of Number) The days of the week to include in the policy's access window, where Sunday=0, Monday=1,..., Saturday=6 (comma-separated)
- `from_hour` (String) The start time of the policy's access window (pattern: hh:mm:ss)
- `to_hour` (String) The end time of the policy's access window (pattern: hh:mm:ss)



<a id="nestedatt--targets"></a>
### Nested Schema for `targets`

Optional:

- `aws_resource` (Attributes) The AWS resources for the VM access policy. This includes regions, tags, VPC IDs, and account IDs. (see [below for nested schema](#nestedatt--targets--aws_resource))
- `azure_resource` (Attributes) The Azure resources for the VM access policy. This includes regions, tags, resource groups, VNet IDs, and subscriptions. (see [below for nested schema](#nestedatt--targets--azure_resource))
- `fqdnip_resource` (Attributes) The fqdn/ip resources for the VM access policy. This includes FQDN rules and IP rules. (see [below for nested schema](#nestedatt--targets--fqdnip_resource))
- `gcp_resource` (Attributes) The GCP resources for the VM access policy. This includes regions, labels, VPC IDs, and project IDs. (see [below for nested schema](#nestedatt--targets--gcp_resource))

<a id="nestedatt--targets--aws_resource"></a>
### Nested Schema for `targets.aws_resource`

Optional:

- `account_ids` (List of String) The AWS account IDs where the resources are located. This is a list of account identifiers.
- `regions` (List of String) The AWS regions where the resources are located.
- `tags` (Attributes List) The tags used to match AWS resources. This is a list of key-value pairs. (see [below for nested schema](#nestedatt--targets--aws_resource--tags))
- `vpc_ids` (List of String) The VPC IDs where the resources are located. This is a list of VPC identifiers.

<a id="nestedatt--targets--aws_resource--tags"></a>
### Nested Schema for `targets.aws_resource.tags`

Optional:

- `key` (String)
- `value` (List of String)



<a id="nestedatt--targets--azure_resource"></a>
### Nested Schema for `targets.azure_resource`

Optional:

- `regions` (List of String) The Azure regions where the resources are located.
- `resource_groups` (List of String) The Azure resource groups where the resources are located. This is a list of resource group names.
- `subscriptions` (List of String) The Azure subscription IDs where the resources are located. This is a list of subscription identifiers.
- `tags` (Attributes List) The tags used to match Azure resources. This is a list of key-value pairs. (see [below for nested schema](#nestedatt--targets--azure_resource--tags))
- `vnet_ids` (List of String) The Azure Virtual Network IDs where the resources are located. This is a list of VNet identifiers.

<a id="nestedatt--targets--azure_resource--tags"></a>
### Nested Schema for `targets.azure_resource.tags`

Optional:

- `key` (String)
- `value` (List of String)



<a id="nestedatt--targets--fqdnip_resource"></a>
### Nested Schema for `targets.fqdnip_resource`

Optional:

- `fqdn_rules` (Attributes List) The FQDN rules used to match DNS records. This is a list of FQDN rules. (see [below for nested schema](#nestedatt--targets--fqdnip_resource--fqdn_rules))
- `ip_rules` (Attributes List) The IP rules used to match IP addresses and logical names. This is a list of IP rules. (see [below for nested schema](#nestedatt--targets--fqdnip_resource--ip_rules))

<a id="nestedatt--targets--fqdnip_resource--fqdn_rules"></a>
### Nested Schema for `targets.fqdnip_resource.fqdn_rules`

Optional:

- `computername_pattern` (String) The pattern to match against the computer name. This can be a full FQDN or a partial match.
- `domain` (String) The domain to match against the FQDN. This is optional and can be used to further restrict the match.
- `operator` (String) The operator to use for matching the FQDN. Valid values are EXACTLY, WILDCARD, PREFIX, SUFFIX, and CONTAINS.


<a id="nestedatt--targets--fqdnip_resource--ip_rules"></a>
### Nested Schema for `targets.fqdnip_resource.ip_rules`

Optional:

- `ip_addresses` (List of String) The list of IP addresses to match against. This can include both IPv4 and IPv6 addresses.
- `logical_name` (String) The logical name of the network.
- `operator` (String) The operator to use for matching the IP addresses. Valid values are EXACTLY and WILDCARD.



<a id="nestedatt--targets--gcp_resource"></a>
### Nested Schema for `targets.gcp_resource`

Optional:

- `labels` (Attributes List) The labels used to match GCP resources. This is a list of key-value pairs. (see [below for nested schema](#nestedatt--targets--gcp_resource--labels))
- `projects` (List of String) The GCP project IDs where the resources are located. This is a list of project identifiers.
- `regions` (List of String) The GCP regions where the resources are located.
- `vpc_ids` (List of String) The GCP VPC IDs where the resources are located. This is a list of VPC identifiers.

<a id="nestedatt--targets--gcp_resource--labels"></a>
### Nested Schema for `targets.gcp_resource.labels`

Optional:

- `key` (String)
- `value` (List of String)




